<UserControl x:Class="NET.Paint.View.Component.Tools.ToolBox"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
             xmlns:tools="clr-namespace:NET.Paint.Drawing.Model;assembly=NET.Paint.Drawing"
             xmlns:icons="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
             xmlns:converters="clr-namespace:NET.Paint.Converter"
             xmlns:constants="clr-namespace:NET.Paint.Drawing.Constant;assembly=NET.Paint.Drawing"
             xmlns:service="clr-namespace:NET.Paint.Drawing.Service;assembly=NET.Paint.Drawing"
             xmlns:selectors="clr-namespace:NET.Paint.Selector"
             xmlns:controls="clr-namespace:NET.Paint.View.Component.Tools.Controls"
             mc:Ignorable="d" 
             d:DesignHeight="900" d:DesignWidth="41" d:Background="White"
             d:DataContext="{d:DesignInstance Type=service:XService, IsDesignTimeCreatable=True}">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../../../Resources/ToolIcons.xaml"/>
                <ResourceDictionary Source="../../../Resources/ShapeIcons.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <selectors:SelectorTemplateSelector x:Key="SelectorTemplateSelector" EmptyTemplate="{StaticResource SelectorToolIcon}"
                                               PointerTemplate="{StaticResource PointerToolIcon}" RectangleTemplate="{StaticResource SelectorToolIcon}" 
                                               LassoTemplate="{StaticResource LassoToolIcon}" MoveTemplate="{StaticResource MoveToolIcon}" RotateTemplate="{StaticResource RotateToolIcon}"/>
            <selectors:PolygonTemplateSelector x:Key="PolygonTemplateSelector" EmptyTemplate="{StaticResource PolygonToolIcon}"
                                              RegularTemplate="{StaticResource PentagonShape}" StarTemplate="{StaticResource StarShape}" HeartTemplate="{StaticResource HeartShape}" 
                                              ArrowTemplate="{StaticResource ArrowShape}" SpiralTemplate="{StaticResource SpiralShape}" CloudTemplate="{StaticResource CloudShape}"/>
            <selectors:EvenOddTemplateSelector x:Key="RectangleTemplateSelector" EmptyTemplate="{StaticResource RectangleToolIcon}"
                                   EvenTemplate="{StaticResource SquareToolIcon}" OddTemplate="{StaticResource RectangleToolIcon}"/>
            <selectors:EvenOddTemplateSelector x:Key="EllipseTemplateSelector" EmptyTemplate="{StaticResource EllipseToolIcon}"
                                   EvenTemplate="{StaticResource CircleToolIcon}" OddTemplate="{StaticResource EllipseToolIcon}"/>
            <selectors:EvenOddTemplateSelector x:Key="PencilTemplateSelector" EmptyTemplate="{StaticResource PencilToolIcon}"
                                   EvenTemplate="{StaticResource PencilToolIcon}" OddTemplate="{StaticResource EraserToolIcon}"/>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid DataContext="{Binding Tools}">
        <DockPanel LastChildFill="True" Margin="5">
            <StackPanel DockPanel.Dock="Top">
                <RadioButton x:Name="SelectorToolSelect" Style="{StaticResource {x:Type ToggleButton}}" Content="{Binding SelectionMode}" ContentTemplateSelector="{StaticResource SelectorTemplateSelector}" IsChecked="{Binding ActiveTool, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XToolType.Selector}}" GroupName="SelectedTool" Height="25" Click="OpenSelectorQuickSelect"/>
                <RadioButton x:Name="PencilToolSelect" Margin="0,5" Style="{StaticResource {x:Type ToggleButton}}" Content="{Binding PencilMode}" ContentTemplateSelector="{StaticResource PencilTemplateSelector}" IsChecked="{Binding ActiveTool, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XToolType.Pencil}}" GroupName="SelectedTool" Height="25" Click="OpenPencilQuickSelect"/>
                <RadioButton Style="{StaticResource {x:Type ToggleButton}}" ContentTemplate="{StaticResource LineToolIcon}" IsChecked="{Binding ActiveTool, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XToolType.Line}}" GroupName="SelectedTool" Height="25"/>
                <RadioButton Margin="0,5" Style="{StaticResource {x:Type ToggleButton}}" ContentTemplate="{StaticResource CurveToolIcon}" IsChecked="{Binding ActiveTool, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XToolType.Curve}}" GroupName="SelectedTool" Height="25"/>
                <RadioButton Style="{StaticResource {x:Type ToggleButton}}" ContentTemplate="{StaticResource BezierToolIcon}" IsChecked="{Binding ActiveTool, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XToolType.Bezier}}" GroupName="SelectedTool" Height="25"/>
                <RadioButton Margin="0,5" x:Name="EllipseToolSelect" Style="{StaticResource {x:Type ToggleButton}}" Content="{Binding ActiveEllipse}" ContentTemplateSelector="{StaticResource EllipseTemplateSelector}" IsChecked="{Binding ActiveTool, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XToolType.Ellipse}}" GroupName="SelectedTool" Height="25" Click="OpenEllipseQuickSelect"/>
                <RadioButton Style="{StaticResource {x:Type ToggleButton}}" ContentTemplate="{StaticResource TriangleToolIcon}" IsChecked="{Binding ActiveTool, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XToolType.Triangle}}" GroupName="SelectedTool" Height="25"/>
                <RadioButton Margin="0,5" x:Name="RectangleToolSelect" Style="{StaticResource {x:Type ToggleButton}}" Content="{Binding ActiveRectangle}" ContentTemplateSelector="{StaticResource RectangleTemplateSelector}" IsChecked="{Binding ActiveTool, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XToolType.Rectangle}}" GroupName="SelectedTool" Height="25" Click="OpenRectangleQuickSelect"/>
                <RadioButton x:Name="PolygonToolSelect" Style="{StaticResource {x:Type ToggleButton}}" Content="{Binding ActivePolygon}" ContentTemplateSelector="{StaticResource PolygonTemplateSelector}" IsChecked="{Binding ActiveTool, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XToolType.Polygon}}" GroupName="SelectedTool" Height="25" Click="OpenPolygonQuickSelect"/>
                <RadioButton Margin="0,5" Style="{StaticResource {x:Type ToggleButton}}" ContentTemplate="{StaticResource TextToolIcon}" IsChecked="{Binding ActiveTool, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XToolType.Text}}" GroupName="SelectedTool" Height="25"/>
                <RadioButton Style="{StaticResource {x:Type ToggleButton}}" ContentTemplate="{StaticResource BitmapToolIcon}" IsChecked="{Binding ActiveTool, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XToolType.Bitmap}}" GroupName="SelectedTool" Height="25"/>
                <RadioButton Style="{StaticResource {x:Type ToggleButton}}" Margin="0,5" Content="{icons:MaterialIconExt Kind=FunctionVariant}" IsChecked="{Binding ActiveTool, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XToolType.Effect}}" GroupName="SelectedTool" Height="25"/>
            </StackPanel>

            <StackPanel DockPanel.Dock="Bottom">
                <ToggleButton x:Name="GridToolSelect" Height="25" ContentTemplate="{StaticResource GridToolIcon}" IsChecked="{Binding IsOpen, ElementName=GridQuickSelect}"/>
                <ToggleButton Margin="0,5" x:Name="ZoomToolSelect" Height="25" ContentTemplate="{StaticResource ZoomToolIcon}" IsChecked="{Binding IsOpen, ElementName=ZoomQuickSelect}"/>
                <ToggleButton x:Name="RulerToolSelect" Height="25" ContentTemplate="{StaticResource RulerToolIcon}" IsChecked="{Binding IsOpen, ElementName=RulerQuickSelect}"/>
            </StackPanel>

            <Grid>
                <StackPanel Height="90">
                    <Border BorderBrush="DimGray" BorderThickness="1">
                        <xctk:ColorPicker SelectedColor="{Binding PrimaryColor, Mode=TwoWay}" Height="25" VerticalContentAlignment="Stretch" ShowDropDownButton="False" Background="{Binding PrimaryColor, Converter={StaticResource ColorToBrushConverter}}"/>
                    </Border>
                    <ToggleButton x:Name="ThicknessToolSelect" Height="25" ContentTemplate="{StaticResource ThicknessToolIcon}" IsChecked="{Binding IsOpen, ElementName=ThicknessQuickSelect}" VerticalContentAlignment="Center" HorizontalContentAlignment="Center" Margin="0,5"/>
                    <Border BorderBrush="DimGray" BorderThickness="1" Margin="0,0,0,25">
                        <xctk:ColorPicker SelectedColor="{Binding SecondaryColor, Mode=TwoWay}" Height="25" VerticalContentAlignment="Stretch" ShowDropDownButton="False"  Background="{Binding SecondaryColor, Converter={StaticResource ColorToBrushConverter}}"/>
                    </Border>
                </StackPanel>
            </Grid>
        </DockPanel>
        
        <Popup x:Name="ThicknessQuickSelect" PlacementTarget="{Binding ElementName=ThicknessToolSelect}" Placement="Left" StaysOpen="False" HorizontalOffset="5" VerticalOffset="-5">
            <Border Background="White" BorderBrush="Black" BorderThickness="1" Padding="5" MouseLeave="CloseThicknessQuickSelect">
                <controls:Thickness Width="150" DataContext="{Binding}"/>
            </Border>
        </Popup>

        <Popup x:Name="GridQuickSelect" PlacementTarget="{Binding ElementName=GridToolSelect}" Placement="Left" StaysOpen="False" HorizontalOffset="5" VerticalOffset="-115">
            <Border Background="White" BorderBrush="Black" BorderThickness="1" Padding="7.5" MouseLeave="CloseGridQuickSelect" DataContext="{Binding DataContext.ActiveImage, RelativeSource={RelativeSource AncestorType=UserControl}}">
                <controls:Grid Width="150" DataContext="{Binding Configuration}"/>
            </Border>
        </Popup>

        <Popup x:Name="ZoomQuickSelect" PlacementTarget="{Binding ElementName=ZoomToolSelect}" Placement="Left" StaysOpen="False" HorizontalOffset="5" VerticalOffset="-5">
            <Border Background="White" BorderBrush="Black" BorderThickness="1" Padding="5" MouseLeave="CloseZoomQuickSelect" DataContext="{Binding DataContext.ActiveImage, RelativeSource={RelativeSource AncestorType=UserControl}}">
                <controls:Zoom Width="150" DataContext="{Binding Configuration}"/>
            </Border>
        </Popup>

        <Popup x:Name="RulerQuickSelect" PlacementTarget="{Binding ElementName=RulerToolSelect}" Placement="Left" StaysOpen="False" HorizontalOffset="5" VerticalOffset="-5">
            <Border Background="White" BorderBrush="Black" BorderThickness="1" Padding="5" MouseLeave="CloseRulerQuickSelect" DataContext="{Binding DataContext.ActiveImage, RelativeSource={RelativeSource AncestorType=UserControl}}">
                <controls:Ruler Width="150" DataContext="{Binding Configuration}"/>
            </Border>
        </Popup>

        <Popup x:Name="PolygonQuickSelect" PlacementTarget="{Binding ElementName=PolygonToolSelect}" Placement="Left" StaysOpen="False" HorizontalOffset="5" VerticalOffset="-5">
            <Border Background="White" BorderBrush="Black" BorderThickness="1" Padding="5" MouseLeave="ClosePolygonQuickSelect">
                <StackPanel Width="25">
                    <RadioButton Height="25" ContentTemplate="{StaticResource PentagonShape}" IsChecked="{Binding ActivePolygon, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XPolygonStyle.Regular}, Mode=TwoWay}" Style="{StaticResource {x:Type ToggleButton}}" GroupName="PolygonSelect"/>
                    <RadioButton Margin="0,5" Height="25" ContentTemplate="{StaticResource StarShape}" IsChecked="{Binding ActivePolygon, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XPolygonStyle.Star}, Mode=TwoWay}" Style="{StaticResource {x:Type ToggleButton}}" GroupName="PolygonSelect"/>
                    <RadioButton Height="25" ContentTemplate="{StaticResource HeartShape}" IsChecked="{Binding ActivePolygon, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XPolygonStyle.Heart}, Mode=TwoWay}" Style="{StaticResource {x:Type ToggleButton}}" GroupName="PolygonSelect"/>
                    <RadioButton Margin="0,5" Height="25" ContentTemplate="{StaticResource ArrowShape}" IsChecked="{Binding ActivePolygon, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XPolygonStyle.Arrow}, Mode=TwoWay}" Style="{StaticResource {x:Type ToggleButton}}" GroupName="PolygonSelect"/>
                    <RadioButton Height="25" ContentTemplate="{StaticResource SpiralShape}" IsChecked="{Binding ActivePolygon, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XPolygonStyle.Spiral}, Mode=TwoWay}" Style="{StaticResource {x:Type ToggleButton}}" GroupName="PolygonSelect"/>
                    <RadioButton Margin="0,5,0,0" Height="25" ContentTemplate="{StaticResource CloudShape}" IsChecked="{Binding ActivePolygon, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XPolygonStyle.Cloud}, Mode=TwoWay}" Style="{StaticResource {x:Type ToggleButton}}" GroupName="PolygonSelect"/>
                </StackPanel>
            </Border>
        </Popup>

        <Popup x:Name="SelectorQuickSelect" PlacementTarget="{Binding ElementName=SelectorToolSelect}" Placement="Left" StaysOpen="False" HorizontalOffset="5" VerticalOffset="-5">
            <Border Background="White" BorderBrush="Black" BorderThickness="1" Padding="5" MouseLeave="CloseSelectorQuickSelect">
                <StackPanel Width="25">
                    <RadioButton Height="25" ContentTemplate="{StaticResource PointerToolIcon}" IsChecked="{Binding SelectionMode, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XSelectionMode.Pointer}, Mode=TwoWay}" Style="{StaticResource {x:Type ToggleButton}}" GroupName="SelectorSelect"/>
                    <RadioButton Margin="0,5" Height="25" ContentTemplate="{StaticResource SelectorToolIcon}" IsChecked="{Binding SelectionMode, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XSelectionMode.Rectangle}, Mode=TwoWay}" Style="{StaticResource {x:Type ToggleButton}}" GroupName="SelectorSelect"/>
                    <RadioButton Height="25" ContentTemplate="{StaticResource LassoToolIcon}" IsChecked="{Binding SelectionMode, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XSelectionMode.Lasso}, Mode=TwoWay}" Style="{StaticResource {x:Type ToggleButton}}" GroupName="SelectorSelect"/>
                </StackPanel>
            </Border>
        </Popup>

        <Popup x:Name="PencilQuickSelect" PlacementTarget="{Binding ElementName=PencilToolSelect}" Placement="Left" StaysOpen="False" HorizontalOffset="5" VerticalOffset="-5">
            <Border Background="White" BorderBrush="Black" BorderThickness="1" Padding="5" MouseLeave="ClosePencilQuickSelect">
                <StackPanel Width="25">
                    <RadioButton Style="{StaticResource {x:Type ToggleButton}}" ContentTemplate="{StaticResource PencilToolIcon}" IsChecked="{Binding PencilMode, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XPencilMode.Add}, Mode=TwoWay}" GroupName="RectangleSelect" Height="25"/>
                    <RadioButton Margin="0,5,0,0" Style="{StaticResource {x:Type ToggleButton}}" ContentTemplate="{StaticResource EraserToolIcon}" IsChecked="{Binding PencilMode, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XPencilMode.Remove}, Mode=TwoWay}" GroupName="RectangleSelect" Height="25"/>
                </StackPanel>
            </Border>
        </Popup>

        <Popup x:Name="RectangleQuickSelect" PlacementTarget="{Binding ElementName=RectangleToolSelect}" Placement="Left" StaysOpen="False" HorizontalOffset="5" VerticalOffset="-5">
            <Border Background="White" BorderBrush="Black" BorderThickness="1" Padding="5" MouseLeave="CloseRectangleQuickSelect">
                <StackPanel Width="25">
                    <RadioButton Style="{StaticResource {x:Type ToggleButton}}" ContentTemplate="{StaticResource RectangleToolIcon}" IsChecked="{Binding ActiveRectangle, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XRectangleStyle.Rectangle}, Mode=TwoWay}" GroupName="RectangleSelect" Height="25"/>
                    <RadioButton Margin="0,5,0,0" Style="{StaticResource {x:Type ToggleButton}}" ContentTemplate="{StaticResource SquareToolIcon}" IsChecked="{Binding ActiveRectangle, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XRectangleStyle.Square}, Mode=TwoWay}" GroupName="RectangleSelect" Height="25"/>
                </StackPanel>
            </Border>
        </Popup>

        <Popup x:Name="EllipseQuickSelect" PlacementTarget="{Binding ElementName=EllipseToolSelect}" Placement="Left" StaysOpen="False" HorizontalOffset="5" VerticalOffset="-5">
            <Border Background="White" BorderBrush="Black" BorderThickness="1" Padding="5" MouseLeave="CloseEllipseQuickSelect">
                <StackPanel Width="25">
                    <RadioButton Style="{StaticResource {x:Type ToggleButton}}" ContentTemplate="{StaticResource EllipseToolIcon}" IsChecked="{Binding ActiveEllipse, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XEllipseStyle.Ellipse}, Mode=TwoWay}" GroupName="EllipseSelect" Height="25"/>
                    <RadioButton Margin="0,5,0,0" Style="{StaticResource {x:Type ToggleButton}}" ContentTemplate="{StaticResource CircleToolIcon}" IsChecked="{Binding ActiveEllipse, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static constants:XEllipseStyle.Circle}, Mode=TwoWay}" GroupName="EllipseSelect" Height="25"/>
                </StackPanel>
            </Border>
        </Popup>
    </Grid>
</UserControl>
