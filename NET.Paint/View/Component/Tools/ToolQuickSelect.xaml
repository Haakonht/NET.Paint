<UserControl x:Class="NET.Paint.View.Component.Tools.ToolQuickSelect"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:ma="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
             xmlns:local="clr-namespace:NET.Paint.View.Component.Tools"
             xmlns:service="clr-namespace:NET.Paint.Drawing.Service;assembly=NET.Paint.Drawing"
             xmlns:selectors="clr-namespace:NET.Paint.Selector"
             mc:Ignorable="d" 
             d:DesignHeight="150" d:DesignWidth="150" d:Background="White"
             d:DataContext="{d:DesignInstance Type=service:XService, IsDesignTimeCreatable=True}">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="../../../Resources/ToolIcons.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <DrawingImage x:Key="CircleSegment">
                <DrawingImage.Drawing>
                    <GeometryDrawing>
                        <GeometryDrawing.Brush>
                            <SolidColorBrush Color="LightGray" Opacity="0.6"/>
                        </GeometryDrawing.Brush>
                        <GeometryDrawing.Pen>
                            <Pen Brush="Black" />
                        </GeometryDrawing.Pen>
                        <GeometryDrawing.Geometry>
                            <PathGeometry>
                                <PathFigure StartPoint="100,100">
                                    <PathFigure.Segments>
                                        <LineSegment Point="100,0"/>
                                        <ArcSegment Point="186.6,150" SweepDirection="Clockwise" Size="100,100"/>
                                        <LineSegment Point="100,100"/>
                                    </PathFigure.Segments>
                                </PathFigure>
                            </PathGeometry>
                        </GeometryDrawing.Geometry>
                    </GeometryDrawing>
                </DrawingImage.Drawing>
            </DrawingImage>

            <selectors:SelectorTemplateSelector x:Key="SelectorTemplateSelector" EmptyTemplate="{StaticResource SelectorToolIcon}"
                                               PointerTemplate="{StaticResource PointerToolIcon}" RectangleTemplate="{StaticResource SelectorToolIcon}" 
                                               LassoTemplate="{StaticResource LassoToolIcon}" MoveTemplate="{StaticResource ManipulatorToolIcon}"/>

            <selectors:PolygonTemplateSelector x:Key="PolygonTemplateSelector" EmptyTemplate="{StaticResource PolygonToolIcon}"
                                              RegularTemplate="{StaticResource PentagonShape}" StarTemplate="{StaticResource StarShape}" HeartTemplate="{StaticResource HeartShape}" 
                                              ArrowTemplate="{StaticResource ArrowShape}" SpiralTemplate="{StaticResource SpiralShape}" CloudTemplate="{StaticResource CloudShape}"/>

            <DataTemplate x:Key="PolygonQuickSelectPresenter">
                <ContentPresenter Canvas.Left="38" Canvas.Top="3" Content="{Binding DataContext.Tools.ActivePolygon, RelativeSource={RelativeSource AncestorType=Canvas}}"  ContentTemplateSelector="{StaticResource PolygonTemplateSelector}"/>
            </DataTemplate>

            <DataTemplate x:Key="DefaultQuickSelectPresenter">
                <ContentPresenter Canvas.Left="38" Canvas.Top="3" Content="{Binding}" ContentTemplateSelector="{StaticResource ToolIconTemplateSelector}"/>
            </DataTemplate>

            <DataTemplate x:Key="SelectorQuickSelectPresenter">
                <ContentPresenter Canvas.Left="38" Canvas.Top="3" Content="{Binding DataContext.Tools.SelectionMode, RelativeSource={RelativeSource AncestorType=Canvas}}" ContentTemplateSelector="{StaticResource SelectorTemplateSelector}"/>
            </DataTemplate>

            <selectors:ToolContextQuickSelectTemplateSelector x:Key="ToolContextQuickSelectTemplateSelector" DefaultTemplate="{StaticResource DefaultQuickSelectPresenter}" PolygonTemplate="{StaticResource PolygonQuickSelectPresenter}" SelectorTemplate="{StaticResource SelectorQuickSelectPresenter}"/>
        </ResourceDictionary>
    </UserControl.Resources>
    
    <Canvas Background="Transparent" Width="100" Height="100">
        <Canvas Width="100" Height="100" Canvas.Top="-9.5"  Canvas.Left="34">
            <Image Canvas.Left="50" Canvas.Top="0" Width="50" MouseEnter="OpenToolContextSpecific" Tag="2" Source="{StaticResource CircleSegment}"/>
            <Image Canvas.Left="34" Canvas.Top="59" Width="50" MouseEnter="OpenToolContextSpecific" Tag="1" Source="{StaticResource CircleSegment}">
                <Image.RenderTransform>
                    <RotateTransform Angle="120" CenterX="25" CenterY="25"/>
                </Image.RenderTransform>
            </Image>
            <Image Canvas.Left="-9" Canvas.Top="16" Width="50" MouseEnter="OpenToolContextSpecific" Tag="0" Source="{StaticResource CircleSegment}">
                <Image.RenderTransform>
                    <RotateTransform Angle="240" CenterX="25" CenterY="25"/>
                </Image.RenderTransform>
            </Image>
            <Canvas.RenderTransform>
                <RotateTransform Angle="60" CenterX="25" CenterY="25"/>
            </Canvas.RenderTransform>
        </Canvas>
        <Ellipse Stroke="Black" StrokeThickness="1" Fill="White" Height="40" Width="40" Canvas.Left="30" Canvas.Top="30"/>
        <ContentPresenter Canvas.Left="38" Canvas.Top="5" Content="{Binding Tools.ActiveTool}" ContentTemplateSelector="{StaticResource ToolContextQuickSelectTemplateSelector}"/>
        <ma:MaterialIcon Canvas.Left="10" Canvas.Top="55" Kind="ShapeOutline" FontSize="50"/>
        <ma:MaterialIcon Canvas.Left="65" Canvas.Top="55" Kind="Shape" FontSize="50"/>
    </Canvas>
</UserControl>
